# A generic, single database configuration.

[alembic]
# Путь к скриптам миграций (папка alembic)
script_location = alembic

# Добавляем текущую папку в путь импорта, чтобы Alembic видел app.models
prepend_sys_path = .

# Шаблон имен файлов миграций.
# %%(year)d... создает файлы вида "2024_01_20_1200_initial_migration.py"
# Это гораздо удобнее для сортировки, чем случайные хеши.
file_template = %%(year)d_%%(month).2d_%%(day).2d_%%(hour).2d%%(minute).2d-%%(slug)s

# timezone для даты в названии файла
timezone = UTC

# URL базы данных.
# ВАЖНО: Мы закомментировали его здесь, потому что задаем его
# динамически в alembic/env.py через app.config.settings.
# Это безопасно (пароль не лежит в файле).
# sqlalchemy.url = driver://user:pass@localhost/dbname


[post_write_hooks]
# Здесь можно добавить хуки, например, чтобы форматировать код миграций через Black.
# Пока оставим пустым, чтобы не усложнять.

# --- Настройки логгеров (чтобы видеть SQL запросы в консоли) ---

[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
# Установи INFO, чтобы видеть SQL-запросы, или WARN, чтобы было тихо
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers =
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S